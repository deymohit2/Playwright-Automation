FROM mcr.microsoft.com/vscode/devcontainers/python:3.11

# System deps for Playwright
RUN apt-get update && export DEBIAN_FRONTEND=noninteractive \
  && apt-get install -y --no-install-recommends \
      libnss3 libatk1.0-0 libatk-bridge2.0-0 libcups2 libxkbcommon0 libxcomposite1 libxrandr2 libasound2 \
      libgbm1 libgtk-3-0 libdbus-1-3 ca-certificates curl unzip \
  && rm -rf /var/lib/apt/lists/*

WORKDIR /workspace

COPY requirements.txt /workspace/
RUN pip install --upgrade pip && pip install -r requirements.txt

# Install Playwright browsers (Python package provides CLI)
RUN playwright install --with-deps

COPY . /workspace
ENV PYTHONUNBUFFERED=1